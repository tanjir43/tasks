/**
 * crisp-relay-site-helpdesk - Helpdesk site. Serves user helpdesks
 * @version v2.0.0
 * @author Crisp IM SAS https://crisp.chat/
 * @date 5/3/2024
 */
"use strict";function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var _=t[s];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(e,_toPropertyKey(_.key),_)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var _=s.call(e,t||"default");if("object"!==_typeof(_))return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var CrispHelpdeskCommon=new(function(){function e(){var t;_classCallCheck(this,e),this.__search_debounce_delay=100,this.__search_report_delay=1e3,this.__copy_state_confirm_delay=2e3,this.__http_status={success:200},this.__suggest_min_length=2,this.__key_bindings={tabular:9,enter:13,escape:27,up:38,down:40},this.__selectors={},this.__is_language_menu_open=!1,this.__is_pending_search=!1,this.__active_search_query=null,this.__active_search_results=null,this.__search_debounce_timeout=null,this.__search_report_timeout=null,this.__do_show_status_banner=null===(t=sessionStorage)||void 0===t||!t.getItem||"0"!==sessionStorage.getItem("status-banner"),this.__initialize()}return _createClass(e,[{key:"bind",value:function(){this.__toggle_status_banner()}},{key:"hide_status_banner",value:function(){var e;this.__do_show_status_banner=!1,this.__toggle_status_banner(),null!==(e=sessionStorage)&&void 0!==e&&e.setItem&&sessionStorage.setItem("status-banner","0")}},{key:"key_global",value:function(e){var t=!0;switch(e.keyCode){case this.__key_bindings.enter:t=this.__select_active_search_result();break;case this.__key_bindings.up:t=this.__move_active_search_result(-1);break;case this.__key_bindings.down:t=this.__move_active_search_result(1)}return t===!1&&(e.preventDefault(),e.stopPropagation()),t}},{key:"click_global",value:function(e){var t=!0;return this.__check_hide_language(e),t}},{key:"resize_global",value:function(){this.__reset_suggest_active()}},{key:"toggle_language",value:function(){this.__is_language_menu_open=!this.__is_language_menu_open,this.apply_attribute_cache("language",".csh-header-main-actions-locale","expanded",this.__is_language_menu_open)}},{key:"toggle_search_focus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.apply_attribute_cache("search",".csh-header-search","has-focus",e)}},{key:"key_search_field",value:function(e){var t=!0;switch(e.keyCode){case this.__key_bindings.tabular:t=this.__expand_suggest();break;case this.__key_bindings.escape:t=this.__reset_search_active();break;default:e.shiftKey!==!0&&e.metaKey!==!0&&e.ctrlKey!==!0&&e.altKey!==!0&&this.__reset_suggest_active()}return t===!1&&(e.preventDefault(),e.stopPropagation()),t}},{key:"type_search_field",value:function(e){var t=this,s=(e.value||"").trim();s!==(this.__active_search_query||"")&&(this.__clear_search_timeout(),s&&this.__change_pending_search(!0),this.__search_debounce_timeout=setTimeout(function(){t.__active_search_query=s,s?(t.__proceed_suggest(s),t.__proceed_search(s)):(t.__reset_suggest(),t.__reset_search(!1))},s?this.__search_debounce_delay:0))}},{key:"search_search_field",value:function(e){this.type_search_field(e)}},{key:"mouse_search_result",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.__set_active_search_result("mouse",e,t)}},{key:"copy_code_clipboard",value:function(e){var t=e.parentElement||null;if(null!==t){var s,_=(null===(s=t.getElementsByTagName("code"))||void 0===s?void 0:s[0])||null;if(null!==_){var a=this.__copy_text(_);a===!0&&(e.__copy_timeout&&clearTimeout(e.__copy_timeout),t.setAttribute("data-copied","true"),e.__copy_timeout=setTimeout(function(){delete e.__copy_timeout,t.setAttribute("data-copied","false")},this.__copy_state_confirm_delay))}}}},{key:"open_chatbox",value:function(){window.$crisp.push(["do","chat:show"]),window.$crisp.push(["do","chat:open"])}},{key:"go_to_anchor",value:function(e){e.id&&(window.location.hash="#".concat(e.id))}},{key:"select_element_cache",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],_=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this.__selectors[e]=(s===!0?null:this.__selectors[e])||document[_===!0?"querySelector":"querySelectorAll"](t),this.__selectors[e]}},{key:"apply_attribute_cache",value:function(e,t,s,_){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],i=[];if(n===!0){var r=this.select_element_cache(e,t,a,!0);r&&i.push(r)}else i=this.select_element_cache(e,t,a,!1);if(i.length>0)for(var c="data-".concat(s),l=_===!0?"true":"false",o=0;o<i.length;o++)i[o].setAttribute(c,l)}},{key:"submit_payload",value:function(e,t,s){var _=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=new XMLHttpRequest,r=s?JSON.stringify(s):null;i.open(e,t,!0),i.onreadystatechange=function(){4===i.readyState&&(i.status===_.__http_status.success?"function"==typeof a&&a(i):"function"==typeof n&&n(i))},i.setRequestHeader("Content-Type","application/json"),i.send(r)}},{key:"__initialize",value:function(){window.onresize=this.resize_global.bind(this),document.onkeydown=this.key_global.bind(this),document.onclick=this.click_global.bind(this)}},{key:"__load_include",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,_=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a="";if(null!==t)for(var n in t)a&&(a+="&"),a+="".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(t[n]));a&&(a="?".concat(a));var i=new XMLHttpRequest;i.open("GET","".concat(e).concat(a)),i.responseType="document";var r=this;i.onload=function(){this.status===r.__http_status.success?"function"==typeof s&&s(this.response):"function"==typeof _&&_()},i.onerror=function(){"function"==typeof _&&_()},i.send()}},{key:"__toggle_status_banner",value:function(){var e=document.querySelector("mark");e&&(e.style.display=this.__do_show_status_banner===!0?"block":"none")}},{key:"__clear_search_timeout",value:function(){null!==this.__search_debounce_timeout&&(clearTimeout(this.__search_debounce_timeout),this.__search_debounce_timeout=null),null!==this.__search_report_timeout&&(clearTimeout(this.__search_report_timeout),this.__search_report_timeout=null)}},{key:"__change_pending_search",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.__is_pending_search!==e&&(this.__is_pending_search=e,this.apply_attribute_cache("search",".csh-header-search","pending",this.__is_pending_search))}},{key:"__set_active_search_result",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.apply_attribute_cache("search_result",".csh-include-search-result","active",!1,!0,!1),null!==t&&(t.setAttribute("data-active",s===!0?"true":"false"),"keyboard"===e&&t.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}))}},{key:"__select_active_search_result",value:function(){if(null!==this.__active_search_results){var e=this.__active_search_results.querySelector(".csh-include-search-result[data-active='true']");if(e)return e.click(),!1}return!0}},{key:"__move_active_search_result",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(null!==this.__active_search_results){var t=this.__active_search_results.querySelectorAll(".csh-include-search-result");if((null===t||void 0===t?void 0:t.length)>0){for(var s=-1,_=0;_<t.length;_++)if("true"===t[_].getAttribute("data-active")){s=_;break}if(s+=e,s<0?s=t.length-1:s>=t.length&&(s=0),s>-1)return this.__set_active_search_result("keyboard",t[s],!0),!1}}return!0}},{key:"__expand_suggest",value:function(){if(null!==this.__active_search_results){var e=this.select_element_cache("autocomplete",".csh-header-search-field-autocomplete"),t=(e.innerText||"").trim();if(t){var s=this.__select_search_field();s.value="".concat(s.value||"").concat(t),this.__reset_suggest()}return!1}return!0}},{key:"__reset_search",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.__clear_search_timeout(),this.__active_search_query=null,this.__active_search_results=null,this.__change_pending_search(!1),this.apply_attribute_cache("search",".csh-header-search","expanded",!1),e===!0){var t=this.__select_search_field();t.value=""}}},{key:"__reset_search_active",value:function(){return null===this.__active_search_results||(this.__reset_suggest(),this.__reset_search(!0),!1)}},{key:"__reset_suggest",value:function(){var e=this.select_element_cache("autocomplete",".csh-header-search-field-autocomplete");e.style.display="none",e.innerText=""}},{key:"__reset_suggest_active",value:function(){null!==this.__active_search_results&&this.__reset_suggest()}},{key:"__check_hide_language",value:function(e){if(this.__is_language_menu_open===!0){var t=e.path||("function"==typeof e.composedPath?e.composedPath():[]);if((null===t||void 0===t?void 0:t.length)>0){for(var s=this.select_element_cache("language",".csh-header-main-actions-locale"),_=!1,a=0;a<t.length;a++)if(t[a]===s){_=!0;break}_===!1&&this.toggle_language()}}}},{key:"__proceed_search",value:function(e){var t=this,s=this.select_element_cache("search",".csh-header-search");this.__load_include(s.getAttribute("action"),{query:e},function(s){if(e===t.__active_search_query){t.__change_pending_search(!1);var _=s.getElementsByClassName("csh-include-search");if(null!==_&&void 0!==_&&_[0]){var a=t.select_element_cache("search_results",".csh-header-search-results");for(t.__active_search_results=_[0];a.firstChild;)a.removeChild(a.firstChild);a.appendChild(_[0]),t.apply_attribute_cache("search",".csh-header-search","expanded",!0)}t.__search_report_timeout=setTimeout(function(){e===t.__active_search_query&&t.__proceed_report(e)},t.__search_report_delay)}},function(){e===t.__active_search_query&&t.__reset_search(!1)})}},{key:"__proceed_suggest",value:function(e){var t=this,s=this.select_element_cache("search",".csh-header-search"),_=e.substring(e.lastIndexOf(" ")+1).trim();_&&_.length>=this.__suggest_min_length&&this.__load_include(s.getAttribute("data-target-suggest"),{part:_},function(e){var s=e.getElementsByClassName("csh-include-suggest"),_=[];null!==s&&void 0!==s&&s[0]&&_.push(s[0].innerText);var a=(_[0]||"").toLowerCase(),n=null,i=null;if(a){var r=t.__select_search_field();i=r.value||"";var c=i.substring(i.lastIndexOf(" ")+1).trim().toLowerCase();c&&c.length<a.length&&a.substring(0,c.length)===c&&(n=a.substring(c.length))}if(n&&i){var l=t.select_element_cache("ruler_text",".csh-header-search-field-ruler-text");l.innerText=i;var o=t.select_element_cache("autocomplete",".csh-header-search-field-autocomplete");if(o.innerText=n,o.style.display="inline-block","rtl"===document.dir?o.style.left="".concat(l.offsetLeft-o.offsetWidth,"px"):o.style.left="".concat(l.offsetLeft+l.offsetWidth,"px"),"function"==typeof window.getComputedStyle){var u=window.getComputedStyle(l.parentElement,null);if("rtl"===document.dir)o.offsetLeft<=parseInt(u.paddingLeft,10)&&t.__reset_suggest();else{var h=o.clientWidth+(o.offsetLeft-parseInt(u.paddingLeft,10));h>=parseInt(u.width,10)&&t.__reset_suggest()}}}else t.__reset_suggest()})}},{key:"__proceed_report",value:function(e){var t=this.select_element_cache("search",".csh-header-search");this.submit_payload("POST",t.getAttribute("data-target-report"),{query:e})}},{key:"__select_search_field",value:function(){return this.select_element_cache("search_field","input[name='search_query']")}},{key:"__copy_text",value:function(e){var t=!1;try{var s=document.createRange();s.selectNode(e),window.getSelection().removeAllRanges(),window.getSelection().addRange(s),document.execCommand("copy"),window.getSelection().removeAllRanges(),t=!0}catch(e){}return t}}]),e}());window.onload=function(){CrispHelpdeskCommon.bind()};